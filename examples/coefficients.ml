(* FIR and Upsampling Filters in OCaml
 * Copyright (c) 2015, Colin Shaw
 * Distributed under the terms of the MIT License 
 *)

(* Linear phase low pass, cutoff approx 1kHz, 44.1kHz sample rate *)
let filter = [ 
    0.0052984630649181505;
    0.0007217262051083255;
    0.0007228400596538052;
    0.0006880033543891585;
    0.0006132028720578763;
    0.0004946822942689868;
    0.00032913194495858656;
    0.0001140510977153618;
    -0.00015224075815291848;
    -0.00047077440584304914;
    -0.0008422491012547806;
    -0.0012669565152948097;
    -0.0017437902660837527;
    -0.0022684932440045187;
    -0.0028358302283874874;
    -0.00344631781245995;
    -0.004087900719166745;
    -0.004756527831576547;
    -0.0054423903831486015;
    -0.006136173554050623;
    -0.006827360030897164;
    -0.007504498750074335;
    -0.008155321201221937;
    -0.008766767065691171;
    -0.009325341921193381;
    -0.00981756625059892;
    -0.010229866490217935;
    -0.010547955164798761;
    -0.010758777309565353;
    -0.010849946968235486;
    -0.010809015697864308;
    -0.010625738080841872;
    -0.010290024459207384;
    -0.00979424788388656;
    -0.009131878891788186;
    -0.008298220513531386;
    -0.007290740131628015;
    -0.006108950027720608;
    -0.00475443177556599;
    -0.0032311081295771813;
    -0.001545228877578847;
    0.00029502048936383277;
    0.0022779255265062675;
    0.004391994645558328;
    0.006619777493220019;
    0.008945843963114241;
    0.01135098425209327;
    0.013813588374173937;
    0.01631193084849143;
    0.01882337777378453;
    0.02132411384517315;
    0.023789622925988352;
    0.02619533085246346;
    0.028516968708297136;
    0.030730865714362482;
    0.032814144479252995;
    0.034741974628188385;
    0.03650557923930626;
    0.038059995009870694;
    0.039413625135730004;
    0.040544143658551586;
    0.04143504609097396;
    0.04207657547332903;
    0.04246328355513641;
    0.042592462023656026;
    0.04246328355513641;
    0.04207657547332903;
    0.04143504609097396;
    0.040544143658551586;
    0.039413625135730004;
    0.038059995009870694;
    0.03650557923930626;
    0.034741974628188385;
    0.032814144479252995;
    0.030730865714362482;
    0.028516968708297136;
    0.02619533085246346;
    0.023789622925988352;
    0.02132411384517315;
    0.01882337777378453;
    0.01631193084849143;
    0.013813588374173937;
    0.01135098425209327;
    0.008945843963114241;
    0.006619777493220019;
    0.004391994645558328;
    0.0022779255265062675;
    0.00029502048936383277;
    -0.0015452288775788467;
    -0.0032311081295771813;
    -0.00475443177556599;
    -0.006108950027720608;
    -0.007290740131628015;
    -0.008298220513531386;
    -0.009131878891788186;
    -0.00979424788388656;
    -0.010290024459207384;
    -0.010625738080841872;
    -0.010809015697864308;
    -0.010849946968235486;
    -0.010758777309565353;
    -0.010547955164798761;
    -0.010229866490217935;
    -0.00981756625059892;
    -0.009325341921193381;
    -0.00876676706569117;
    -0.008155321201221937;
    -0.007504498750074335;
    -0.006827360030897164;
    -0.006136173554050623;
    -0.0054423903831486015;
    -0.004756527831576547;
    -0.004087900719166745;
    -0.0034463178124599482;
    -0.002835830228387487;
    -0.0022684932440045187;
    -0.0017437902660837527;
    -0.0012669565152948097;
    -0.0008422491012547806;
    -0.00047077440584304914;
    -0.00015224075815291848;
    0.00011405109771535836;
    0.00032913194495858656;
    0.0004946822942689868;
    0.0006132028720578762;
    0.0006880033543891589;
    0.0007228400596538052;
    0.0007217262051083255;
    0.0052984630649181505
    ]

(* Linear phase filter for 176.4kHz sample rate, reasonably sharp cutoff at 20kHz *)
let upsample = [
    -0.000027525219086528868;
    -0.00008134978776744987;
    -0.00016342744126370397;
    -0.00023773651104390004;
    -0.00022381141758829993;
    0.0000021354344511561955;
    0.0005808524467765758;
    0.0016184164838344262;
    0.0031211443037088564;
    0.004941122765465227;
    0.006761665267699855;
    0.008144913443272223;
    0.008643591609412025;
    0.007951192875590402;
    0.006040598768496522;
    0.0032326168417923734;
    0.0001512323311875037;
    -0.0024398601684578304;
    -0.0038768025748109024;
    -0.003829636646506507;
    -0.0024386389316525584;
    -0.00028783267587607366;
    0.0017905576207155676;
    0.003017750374009483;
    0.0029629338223270984;
    0.0017106159749142856;
    -0.00017486355015970686;
    -0.0018822068807408427;
    -0.002692958506899993;
    -0.0022866238095389396;
    -0.0008778584500511627;
    0.0008790781370432019;
    0.002182074013028106;
    0.002442762230973483;
    0.001555349010013265;
    -0.00005276305643183996;
    -0.001616989360592381;
    -0.002392348110573643;
    -0.002006779499903723;
    -0.0006432844937759501;
    0.0010404267579717783;
    0.002222884871519937;
    0.00231611649977377;
    0.0012582756922456216;
    -0.0004444887783720771;
    -0.0019550204003658225;
    -0.0025126257273867776;
    -0.0018144973418273349;
    -0.00018038134797792186;
    0.0015891903964150435;
    0.002600896527705272;
    0.0023167998433449343;
    0.0008390588526157867;
    -0.0011189809299390532;
    -0.0025730258663340107;
    -0.0027592303749255135;
    -0.001533004655322894;
    0.0005319294065104395;
    0.0024076454937838336;
    0.003120105106100797;
    0.002251862562584289;
    0.00018139233112594754;
    -0.002075940515590367;
    -0.0033620035767431334;
    -0.0029666797571711273;
    -0.0010155872660560937;
    0.0015548921509962925;
    0.0034425518932228957;
    0.0036352471102080743;
    0.0019493149396653195;
    -0.0008337781475971963;
    -0.0033237112315884377;
    -0.004211327404852616;
    -0.0029522594271788505;
    -0.00008954374282008134;
    0.00297113934974805;
    0.004646137827052102;
    0.003987756208027288;
    0.0012118667678917222;
    -0.002350504457628022;
    -0.004884281742534622;
    -0.00500860089718552;
    -0.002520954548170332;
    0.0014296999350157202;
    0.004863693827077366;
    0.005954562972048922;
    0.003991200693073062;
    -0.00018397150424708826;
    -0.004520386151700957;
    -0.006755916342887474;
    -0.005585629220284116;
    -0.001404519055083129;
    0.0037896791192244947;
    0.007336616303661162;
    0.007261205053829378;
    0.0033536380881673735;
    -0.0025993805747702896;
    -0.007610415251295384;
    -0.008970532413792712;
    -0.005689265125934656;
    0.0008580730815674087;
    0.00747102419772578;
    0.010660159005027552;
    0.00845471024943999;
    0.0015618621095922441;
    -0.006777917824150836;
    -0.012271602296269528;
    -0.01173360584628308;
    -0.004861909389029786;
    0.005325991474788565;
    0.013747117838913258;
    0.015708840213819585;
    0.00941557897584514;
    -0.002761409589605004;
    -0.015035276317321922;
    -0.02081246949732487;
    -0.016038670080309306;
    -0.0016690174098504837;
    0.0160921360604704;
    0.028186883262462246;
    0.026897049902903498;
    0.010033699329332258;
    -0.016879819146282185;
    -0.04171373264642965;
    -0.05002892141923553;
    -0.031013150338731768;
    0.017366905301921448;
    0.08627929387301009;
    0.15813669439320405;
    0.2123291453832786;
    0.232468153046786;
    0.21232914538327863;
    0.15813669439320405;
    0.08627929387301009;
    0.017366905301921448;
    -0.031013150338731768;
    -0.05002892141923553;
    -0.04171373264642965;
    -0.016879819146282185;
    0.010033699329332258;
    0.026897049902903498;
    0.028186883262462246;
    0.0160921360604704;
    -0.0016690174098504752;
    -0.016038670080309306;
    -0.02081246949732487;
    -0.015035276317321922;
    -0.002761409589605004;
    0.009415578975845143;
    0.015708840213819585;
    0.013747117838913265;
    0.005325991474788565;
    -0.004861909389029787;
    -0.01173360584628308;
    -0.012271602296269528;
    -0.006777917824150836;
    0.001561862109592251;
    0.00845471024943999;
    0.010660159005027552;
    0.0074710241977257764;
    0.0008580730815674104;
    -0.005689265125934656;
    -0.008970532413792712;
    -0.007610415251295381;
    -0.0025993805747702896;
    0.0033536380881673752;
    0.00726120505382938;
    0.007336616303661162;
    0.0037896791192244964;
    -0.001404519055083129;
    -0.005585629220284116;
    -0.006755916342887476;
    -0.004520386151700957;
    -0.0001839715042470874;
    0.003991200693073061;
    0.005954562972048922;
    0.004863693827077369;
    0.0014296999350157185;
    -0.002520954548170332;
    -0.00500860089718552;
    -0.004884281742534622;
    -0.002350504457628022;
    0.0012118667678917222;
    0.003987756208027291;
    0.004646137827052104;
    0.0029711393497480467;
    -0.00008954374282008305;
    -0.002952259427178853;
    -0.004211327404852614;
    -0.0033237112315884377;
    -0.0008337781475971989;
    0.0019493149396653195;
    0.0036352471102080743;
    0.003442551893222899;
    0.0015548921509962925;
    -0.0010155872660560937;
    -0.0029666797571711273;
    -0.0033620035767431334;
    -0.002075940515590367;
    0.00018139233112594925;
    0.002251862562584287;
    0.003120105106100799;
    0.002407645493783837;
    0.0005319294065104412;
    -0.001533004655322893;
    -0.002759230374925515;
    -0.002573025866334009;
    -0.001118980929939054;
    0.000839058852615785;
    0.0023167998433449377;
    0.002600896527705273;
    0.0015891903964150417;
    -0.00018038134797792186;
    -0.0018144973418273366;
    -0.0025126257273867776;
    -0.0019550204003658225;
    -0.0004444887783720771;
    0.0012582756922456216;
    0.0023161164997737684;
    0.002222884871519937;
    0.0010404267579717792;
    -0.0006432844937759501;
    -0.0020067794999037245;
    -0.002392348110573643;
    -0.0016169893605923827;
    -0.00005276305643183996;
    0.001555349010013265;
    0.002442762230973483;
    0.002182074013028106;
    0.0008790781370432003;
    -0.0008778584500511627;
    -0.002286623809538938;
    -0.002692958506899993;
    -0.001882206880740841;
    -0.00017486355015970686;
    0.0017106159749142856;
    0.0029629338223270984;
    0.0030177503740094823;
    0.0017905576207155667;
    -0.0002878326758760771;
    -0.0024386389316525597;
    -0.0038296366465065054;
    -0.003876802574810904;
    -0.002439860168457832;
    0.00015123233118750286;
    0.0032326168417923734;
    0.006040598768496525;
    0.007951192875590405;
    0.008643591609412025;
    0.008144913443272223;
    0.006761665267699854;
    0.004941122765465227;
    0.0031211443037088564;
    0.0016184164838344253;
    0.0005808524467765775;
    0.0000021354344511570463;
    -0.0002238114175883008;
    -0.00023773651104390175;
    -0.00016342744126370313;
    -0.00008134978776744817;
    -0.000027525219086528868
]
